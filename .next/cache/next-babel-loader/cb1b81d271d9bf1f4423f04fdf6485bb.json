{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/spencerford/Documents/DEVyall/PersonalProjects/CorporateBingoWeb/pages/login.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useEffect, useContext } from 'react';\nimport { useRouter } from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport FULL_URL from '../constants/constants'; // context imports\n\nimport { UserContext } from '../contexts/userContext';\nimport { OrgContext } from '../contexts/orgContext'; // Style imports\n\nimport { MASTER, COLORS } from '../styles/masterStyles';\n\nvar Login = function Login() {\n  var _useContext = useContext(UserContext),\n      user = _useContext.user,\n      storeUser = _useContext.storeUser;\n\n  var _useContext2 = useContext(OrgContext),\n      contextOrg = _useContext2.contextOrg,\n      getOrg = _useContext2.getOrg;\n\n  var router = useRouter();\n\n  var _useState = useState(''),\n      email = _useState[0],\n      setEmail = _useState[1];\n\n  var _useState2 = useState(''),\n      password = _useState2[0],\n      setPassword = _useState2[1];\n\n  useEffect(function () {\n    if (user.id && localStorage.getItem('bingo_token')) {\n      router.push('/joinGame');\n    }\n  }, [user]);\n\n  var login =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var request, _user;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(!email || !password)) {\n                _context.next = 3;\n                break;\n              }\n\n              alert('Must have both email and password!');\n              return _context.abrupt(\"return\");\n\n            case 3:\n              _context.prev = 3;\n              _context.next = 6;\n              return fetch(\"\".concat(FULL_URL, \"/users/login\"), {\n                method: 'POST',\n                // headers: {\n                //   'Accept': 'application/json',\n                //   'Content-Type': 'application/json'\n                // },\n                body: _JSON$stringify({\n                  email: email,\n                  password: password\n                })\n              });\n\n            case 6:\n              request = _context.sent;\n              _context.next = 9;\n              return request.json();\n\n            case 9:\n              _user = _context.sent;\n\n              if (_user.token) {\n                _context.next = 13;\n                break;\n              }\n\n              alert('Something went wrong... please try again later');\n              return _context.abrupt(\"return\");\n\n            case 13:\n              storeUser(_user);\n              console.log({\n                user: _user\n              });\n\n              if (_user.org && !contextOrg.id) {\n                getOrg(_user.org);\n              }\n\n              router.push('/joinGame');\n              _context.next = 22;\n              break;\n\n            case 19:\n              _context.prev = 19;\n              _context.t0 = _context[\"catch\"](3);\n              alert(_context.t0);\n\n            case 22:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 19]]);\n    }));\n\n    return function login() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var goToSignup = function goToSignup() {\n    router.push('/signup');\n  };\n\n  var goToForgotPassword = function goToForgotPassword() {\n    router.push('/forgotPassword');\n  };\n\n  return __jsx(\"div\", {\n    style: styles.container,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    style: styles.subcontainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    style: MASTER.pageTitle,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, \"LOGIN\"), __jsx(\"input\", {\n    style: MASTER.wideRoundInput,\n    value: email,\n    onChange: function onChange(e) {\n      return setEmail(e.target.value);\n    },\n    placeholder: 'Email',\n    type: \"email\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }), __jsx(\"input\", {\n    style: MASTER.wideRoundInput,\n    value: password,\n    onChange: function onChange(e) {\n      return setPassword(e.target.value);\n    },\n    placeholder: 'Password',\n    type: \"password\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }), __jsx(\"button\", {\n    style: _objectSpread({}, MASTER.wideRoundBtn, {\n      marginTop: 20\n    }),\n    onClick: function onClick() {\n      return login();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, __jsx(\"span\", {\n    style: MASTER.wideRoundBtnText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, \"Login\")), __jsx(\"button\", {\n    style: _objectSpread({}, MASTER.wideRoundBtn, {\n      marginTop: 20\n    }),\n    onClick: function onClick() {\n      return goToSignup();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, __jsx(\"span\", {\n    style: MASTER.wideRoundBtnText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, \"No account yet? Signup!\")), __jsx(\"button\", {\n    style: _objectSpread({}, MASTER.wideRoundBtn, {\n      marginTop: 20,\n      backgroundColor: 'lightgray'\n    }),\n    onClick: function onClick() {\n      return goToForgotPassword();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, __jsx(\"span\", {\n    style: MASTER.wideRoundBtnText,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, \"Forgot my password\"))));\n};\n\nvar styles = {\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center',\n    width: '100%',\n    height: '100%',\n    paddingTop: 40\n  },\n  subcontainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center',\n    width: '100%',\n    height: '100%',\n    maxWidth: 400\n  }\n};\nexport default Login;","map":{"version":3,"sources":["/Users/spencerford/Documents/DEVyall/PersonalProjects/CorporateBingoWeb/pages/login.js"],"names":["useState","useEffect","useContext","useRouter","fetch","FULL_URL","UserContext","OrgContext","MASTER","COLORS","Login","user","storeUser","contextOrg","getOrg","router","email","setEmail","password","setPassword","id","localStorage","getItem","push","login","alert","method","body","request","json","token","console","log","org","goToSignup","goToForgotPassword","styles","container","subcontainer","pageTitle","wideRoundInput","e","target","value","wideRoundBtn","marginTop","wideRoundBtnText","backgroundColor","display","flexDirection","justifyContent","alignItems","width","height","paddingTop","maxWidth"],"mappings":";;;;;;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,UAA9B,QAAgD,OAAhD;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,QAAP,MAAqB,wBAArB,C,CAEA;;AACA,SAASC,WAAT,QAA4B,yBAA5B;AACA,SAASC,UAAT,QAA2B,wBAA3B,C,CAEA;;AACA,SAASC,MAAT,EAAiBC,MAAjB,QAA+B,wBAA/B;;AAEA,IAAMC,KAAK,GAAG,SAARA,KAAQ,GAAM;AAAA,oBAEYR,UAAU,CAACI,WAAD,CAFtB;AAAA,MAERK,IAFQ,eAERA,IAFQ;AAAA,MAEFC,SAFE,eAEFA,SAFE;;AAAA,qBAGeV,UAAU,CAACK,UAAD,CAHzB;AAAA,MAGRM,UAHQ,gBAGRA,UAHQ;AAAA,MAGIC,MAHJ,gBAGIA,MAHJ;;AAKhB,MAAMC,MAAM,GAAGZ,SAAS,EAAxB;;AALgB,kBAOUH,QAAQ,CAAC,EAAD,CAPlB;AAAA,MAOTgB,KAPS;AAAA,MAOFC,QAPE;;AAAA,mBAQgBjB,QAAQ,CAAC,EAAD,CARxB;AAAA,MAQTkB,QARS;AAAA,MAQCC,WARD;;AAUhBlB,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAGU,IAAI,CAACS,EAAL,IAAWC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAd,EAAkD;AAC9CP,MAAAA,MAAM,CAACQ,IAAP,CAAY,WAAZ;AACH;AACF,GAJM,EAIJ,CAACZ,IAAD,CAJI,CAAT;;AAMA,MAAMa,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,oBACP,CAACR,KAAD,IAAU,CAACE,QADJ;AAAA;AAAA;AAAA;;AAENO,cAAAA,KAAK,CAAC,oCAAD,CAAL;AAFM;;AAAA;AAAA;AAAA;AAAA,qBAMgBrB,KAAK,WAAIC,QAAJ,mBAA4B;AACnDqB,gBAAAA,MAAM,EAAE,MAD2C;AAEnD;AACA;AACA;AACA;AACAC,gBAAAA,IAAI,EAAE,gBAAe;AACjBX,kBAAAA,KAAK,EAALA,KADiB;AAEjBE,kBAAAA,QAAQ,EAARA;AAFiB,iBAAf;AAN6C,eAA5B,CANrB;;AAAA;AAMAU,cAAAA,OANA;AAAA;AAAA,qBAiBeA,OAAO,CAACC,IAAR,EAjBf;;AAAA;AAiBElB,cAAAA,KAjBF;;AAAA,kBAkBAA,KAAI,CAACmB,KAlBL;AAAA;AAAA;AAAA;;AAmBAL,cAAAA,KAAK,CAAC,gDAAD,CAAL;AAnBA;;AAAA;AAsBJb,cAAAA,SAAS,CAACD,KAAD,CAAT;AACAoB,cAAAA,OAAO,CAACC,GAAR,CAAY;AAACrB,gBAAAA,IAAI,EAAJA;AAAD,eAAZ;;AACA,kBAAGA,KAAI,CAACsB,GAAL,IAAY,CAACpB,UAAU,CAACO,EAA3B,EAA8B;AAC1BN,gBAAAA,MAAM,CAACH,KAAI,CAACsB,GAAN,CAAN;AACH;;AACDlB,cAAAA,MAAM,CAACQ,IAAP,CAAY,WAAZ;AA3BI;AAAA;;AAAA;AAAA;AAAA;AA4BQE,cAAAA,KAAK,aAAL;;AA5BR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAALD,KAAK;AAAA;AAAA;AAAA,KAAX;;AA+BA,MAAMU,UAAU,GAAG,SAAbA,UAAa,GAAM;AACrBnB,IAAAA,MAAM,CAACQ,IAAP,CAAY,SAAZ;AACH,GAFD;;AAIA,MAAMY,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;AAC7BpB,IAAAA,MAAM,CAACQ,IAAP,CAAY,iBAAZ;AACH,GAFD;;AAIA,SACI;AAAK,IAAA,KAAK,EAAEa,MAAM,CAACC,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,KAAK,EAAED,MAAM,CAACE,YAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI;AAAK,IAAA,KAAK,EAAE9B,MAAM,CAAC+B,SAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADJ,EAEI;AACI,IAAA,KAAK,EAAE/B,MAAM,CAACgC,cADlB;AAEI,IAAA,KAAK,EAAExB,KAFX;AAGI,IAAA,QAAQ,EAAE,kBAAAyB,CAAC;AAAA,aAAIxB,QAAQ,CAACwB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAZ;AAAA,KAHf;AAII,IAAA,WAAW,EAAE,OAJjB;AAKI,IAAA,IAAI,EAAC,OALT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EASI;AACI,IAAA,KAAK,EAAEnC,MAAM,CAACgC,cADlB;AAEI,IAAA,KAAK,EAAEtB,QAFX;AAGI,IAAA,QAAQ,EAAE,kBAAAuB,CAAC;AAAA,aAAItB,WAAW,CAACsB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAf;AAAA,KAHf;AAII,IAAA,WAAW,EAAE,UAJjB;AAKI,IAAA,IAAI,EAAC,UALT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IATJ,EAgBI;AACI,IAAA,KAAK,oBAAOnC,MAAM,CAACoC,YAAd;AAA4BC,MAAAA,SAAS,EAAE;AAAvC,MADT;AAEI,IAAA,OAAO,EAAE;AAAA,aAAMrB,KAAK,EAAX;AAAA,KAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAII;AAAM,IAAA,KAAK,EAAEhB,MAAM,CAACsC,gBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAJJ,CAhBJ,EAsBI;AACI,IAAA,KAAK,oBAAOtC,MAAM,CAACoC,YAAd;AAA4BC,MAAAA,SAAS,EAAE;AAAvC,MADT;AAEI,IAAA,OAAO,EAAE;AAAA,aAAMX,UAAU,EAAhB;AAAA,KAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAII;AAAM,IAAA,KAAK,EAAE1B,MAAM,CAACsC,gBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAJJ,CAtBJ,EA4BI;AACI,IAAA,KAAK,oBAAOtC,MAAM,CAACoC,YAAd;AAA4BC,MAAAA,SAAS,EAAE,EAAvC;AAA2CE,MAAAA,eAAe,EAAE;AAA5D,MADT;AAEI,IAAA,OAAO,EAAE;AAAA,aAAMZ,kBAAkB,EAAxB;AAAA,KAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAII;AAAM,IAAA,KAAK,EAAE3B,MAAM,CAACsC,gBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAJJ,CA5BJ,CADJ,CADJ;AAuCD,CA9FH;;AAgGE,IAAMV,MAAM,GAAG;AACXC,EAAAA,SAAS,EAAE;AACPW,IAAAA,OAAO,EAAE,MADF;AAEPC,IAAAA,aAAa,EAAE,QAFR;AAGPC,IAAAA,cAAc,EAAE,QAHT;AAIPC,IAAAA,UAAU,EAAE,QAJL;AAKPC,IAAAA,KAAK,EAAE,MALA;AAMPC,IAAAA,MAAM,EAAE,MAND;AAOPC,IAAAA,UAAU,EAAE;AAPL,GADA;AAUXhB,EAAAA,YAAY,EAAE;AACZU,IAAAA,OAAO,EAAE,MADG;AAEZC,IAAAA,aAAa,EAAE,QAFH;AAGZC,IAAAA,cAAc,EAAE,QAHJ;AAIZC,IAAAA,UAAU,EAAE,QAJA;AAKZC,IAAAA,KAAK,EAAE,MALK;AAMZC,IAAAA,MAAM,EAAE,MANI;AAOZE,IAAAA,QAAQ,EAAE;AAPE;AAVH,CAAf;AAqBA,eAAe7C,KAAf","sourcesContent":["import { useState, useEffect, useContext } from 'react';\nimport { useRouter } from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport FULL_URL from '../constants/constants';\n\n// context imports\nimport { UserContext } from '../contexts/userContext';\nimport { OrgContext } from '../contexts/orgContext';\n\n// Style imports\nimport { MASTER, COLORS } from '../styles/masterStyles';\n\nconst Login = () => {\n\n    const { user, storeUser } = useContext(UserContext);\n    const { contextOrg, getOrg } = useContext(OrgContext);\n\n    const router = useRouter()\n\n    const [email, setEmail] = useState('');\n    const [password, setPassword] = useState('');\n\n    useEffect(() => {\n        if(user.id && localStorage.getItem('bingo_token')){\n            router.push('/joinGame');\n        }\n      }, [user])\n\n    const login = async () => {\n        if(!email || !password){\n            alert('Must have both email and password!')\n            return;\n        }\n        try {\n            const request = await fetch(`${FULL_URL}/users/login`, {\n                method: 'POST',\n                // headers: {\n                //   'Accept': 'application/json',\n                //   'Content-Type': 'application/json'\n                // },\n                body: JSON.stringify({\n                    email,\n                    password,\n                })\n              })\n              const user = await request.json();\n              if(!user.token){\n                  alert('Something went wrong... please try again later');\n                  return;\n              }\n              storeUser(user);\n              console.log({user})\n              if(user.org && !contextOrg.id){\n                  getOrg(user.org);\n              }\n              router.push('/joinGame');\n            } catch(err) {alert(err)}\n    }\n\n    const goToSignup = () => {\n        router.push('/signup');\n    }\n\n    const goToForgotPassword = () => {\n        router.push('/forgotPassword');\n    }\n\n    return (\n        <div style={styles.container}>\n            <div style={styles.subcontainer}>\n                <div style={MASTER.pageTitle}>LOGIN</div>\n                <input \n                    style={MASTER.wideRoundInput} \n                    value={email} \n                    onChange={e => setEmail(e.target.value)} \n                    placeholder={'Email'}\n                    type='email'\n                />\n                <input \n                    style={MASTER.wideRoundInput} \n                    value={password} \n                    onChange={e => setPassword(e.target.value)} \n                    placeholder={'Password'}\n                    type='password'\n                />\n                <button \n                    style={{ ...MASTER.wideRoundBtn, marginTop: 20 }} \n                    onClick={() => login()}\n                >\n                    <span style={MASTER.wideRoundBtnText}>Login</span>\n                </button>\n                <button \n                    style={{ ...MASTER.wideRoundBtn, marginTop: 20 }} \n                    onClick={() => goToSignup()}\n                >\n                    <span style={MASTER.wideRoundBtnText}>No account yet? Signup!</span>\n                </button>\n                <button \n                    style={{ ...MASTER.wideRoundBtn, marginTop: 20, backgroundColor: 'lightgray' }} \n                    onClick={() => goToForgotPassword()}\n                >\n                    <span style={MASTER.wideRoundBtnText}>Forgot my password</span>\n                </button>\n            </div>\n        </div>\n    )\n  };\n\n  const styles = {\n      container: {\n          display: 'flex',\n          flexDirection: 'column',\n          justifyContent: 'center',\n          alignItems: 'center',\n          width: '100%',\n          height: '100%',\n          paddingTop: 40,\n      },\n      subcontainer: {\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        alignItems: 'center',\n        width: '100%',\n        height: '100%',\n        maxWidth: 400,\n    },\n  }\n  \n  export default Login;"]},"metadata":{},"sourceType":"module"}