{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/spencerford/Documents/DEVyall/PersonalProjects/CorporateBingoWeb/contexts/manageBoardsContext.js\";\nvar __jsx = React.createElement;\nimport React, { createContext, useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport FULL_URL from '../constants/constants';\nexport var ManageBoardsContext = createContext();\n\nvar ManageBoardsContextProvider = function ManageBoardsContextProvider(props) {\n  var router = useRouter();\n\n  var _useState = useState({}),\n      contextBoard = _useState[0],\n      setContextBoard = _useState[1];\n\n  var _useState2 = useState([]),\n      gamesForBoard = _useState2[0],\n      setGamesForBoard = _useState2[1];\n\n  var _useState3 = useState(false),\n      stuffToSave = _useState3[0],\n      setStuffToSave = _useState3[1];\n\n  var getBoard =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(boardID) {\n      var request, board;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(boardID && contextBoard._id === boardID)) {\n                _context.next = 3;\n                break;\n              }\n\n              console.log('go with same board', contextBoard, boardID);\n              return _context.abrupt(\"return\");\n\n            case 3:\n              _context.prev = 3;\n              _context.next = 6;\n              return fetch(\"\".concat(FULL_URL, \"/boards/\").concat(boardID), {\n                method: 'GET',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Bearer \".concat(localStorage.getItem('bingo_token'))\n                }\n              });\n\n            case 6:\n              request = _context.sent;\n              _context.next = 9;\n              return request.json();\n\n            case 9:\n              board = _context.sent;\n              setContextBoard(board);\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](3);\n              alert(_context.t0);\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 13]]);\n    }));\n\n    return function getBoard(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var newBoard =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(orgID) {\n      var request, boardID;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return fetch(\"\".concat(FULL_URL, \"/boards\"), {\n                method: 'POST',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Bearer \".concat(localStorage.getItem('bingo_token'))\n                },\n                body: _JSON$stringify({\n                  orgID: orgID\n                })\n              });\n\n            case 3:\n              request = _context2.sent;\n              _context2.next = 6;\n              return request.json();\n\n            case 6:\n              boardID = _context2.sent;\n              router.push(\"/manageBoards/\".concat(boardID));\n              _context2.next = 13;\n              break;\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](0);\n              alert(_context2.t0);\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 10]]);\n    }));\n\n    return function newBoard(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var saveBoard =\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      var teamsNoFrontendIDs, request, success;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              console.log('SAVING');\n\n              if (contextBoard.groups.useTeams) {\n                teamsNoFrontendIDs = contextBoard.groups.teams.map(function (team) {\n                  if (!team._id || team._id.includes('team')) {\n                    return {\n                      name: team.name,\n                      accessCode: team.accessCode\n                    };\n                  }\n\n                  return team;\n                });\n                contextBoard.groups.teams = teamsNoFrontendIDs;\n              }\n\n              _context3.prev = 2;\n              _context3.next = 5;\n              return fetch(\"\".concat(FULL_URL, \"/boards/\").concat(contextBoard._id), {\n                method: 'PATCH',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Bearer \".concat(localStorage.getItem('bingo_token'))\n                },\n                body: _JSON$stringify(_objectSpread({}, contextBoard, {\n                  modified: new Date()\n                }))\n              });\n\n            case 5:\n              request = _context3.sent;\n              _context3.next = 8;\n              return request.json();\n\n            case 8:\n              success = _context3.sent;\n              console.log({\n                success: success\n              });\n\n              if (success) {\n                setStuffToSave(false);\n                setContextBoard(success.board);\n              } else {\n                alert('There was a problem saving your board... please try again later!');\n              }\n\n              _context3.next = 16;\n              break;\n\n            case 13:\n              _context3.prev = 13;\n              _context3.t0 = _context3[\"catch\"](2);\n              alert(_context3.t0);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[2, 13]]);\n    }));\n\n    return function saveBoard() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var getAllGamesForBoard =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4(boardID) {\n      var request, games;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _context4.next = 3;\n              return fetch(\"\".concat(FULL_URL, \"/boards/gamesForBoard/\").concat(boardID), {\n                method: 'GET',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': \"Bearer \".concat(localStorage.getItem('bingo_token'))\n                }\n              });\n\n            case 3:\n              request = _context4.sent;\n              _context4.next = 6;\n              return request.json();\n\n            case 6:\n              games = _context4.sent;\n              setGamesForBoard(!games.length ? ['none'] : games);\n              _context4.next = 13;\n              break;\n\n            case 10:\n              _context4.prev = 10;\n              _context4.t0 = _context4[\"catch\"](0);\n              alert(_context4.t0);\n\n            case 13:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[0, 10]]);\n    }));\n\n    return function getAllGamesForBoard(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(ManageBoardsContext.Provider, {\n    value: {\n      contextBoard: contextBoard,\n      updateBoard: setContextBoard,\n      getBoard: getBoard,\n      newBoard: newBoard,\n      setStuffToSave: setStuffToSave,\n      stuffToSave: stuffToSave,\n      saveBoard: saveBoard,\n      getAllGamesForBoard: getAllGamesForBoard,\n      gamesForBoard: gamesForBoard\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110\n    },\n    __self: this\n  }, props.children);\n};\n\nexport default ManageBoardsContextProvider;","map":{"version":3,"sources":["/Users/spencerford/Documents/DEVyall/PersonalProjects/CorporateBingoWeb/contexts/manageBoardsContext.js"],"names":["React","createContext","useState","useEffect","useRouter","fetch","FULL_URL","ManageBoardsContext","ManageBoardsContextProvider","props","router","contextBoard","setContextBoard","gamesForBoard","setGamesForBoard","stuffToSave","setStuffToSave","getBoard","boardID","_id","console","log","method","headers","localStorage","getItem","request","json","board","alert","newBoard","orgID","body","push","saveBoard","groups","useTeams","teamsNoFrontendIDs","teams","map","team","includes","name","accessCode","modified","Date","success","getAllGamesForBoard","games","length","updateBoard","children"],"mappings":"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","sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\nimport { useRouter } from 'next/router';\nimport fetch from 'isomorphic-unfetch';\nimport FULL_URL from '../constants/constants';\n\nexport const ManageBoardsContext = createContext();\n\nconst ManageBoardsContextProvider = (props) => {\n    const router = useRouter();\n\n    const [ contextBoard, setContextBoard ] = useState({});\n    const [ gamesForBoard, setGamesForBoard ] = useState([]);\n    const [ stuffToSave, setStuffToSave ] = useState(false);\n\n    const getBoard = async (boardID) => {\n        if(boardID && contextBoard._id === boardID){\n            console.log('go with same board', contextBoard, boardID)\n            return;\n        }\n        try {\n            const request = await fetch(`${FULL_URL}/boards/${boardID}`, {\n                method: 'GET',\n                headers: {\n                    'Accept': 'application/json',\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${localStorage.getItem('bingo_token')}`\n                },\n                })\n                const board = await request.json();\n                setContextBoard(board);\n        } catch(err) {alert(err)}\n    }\n\n    const newBoard = async (orgID) => {\n        try {\n            const request = await fetch(`${FULL_URL}/boards`, {\n                method: 'POST',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': `Bearer ${localStorage.getItem('bingo_token')}`\n                },\n                body: JSON.stringify({\n                    orgID: orgID\n                })\n              })\n              const boardID = await request.json();\n              router.push(`/manageBoards/${boardID}`);\n\n        } catch(err) {alert(err)}\n    }\n\n    const saveBoard = async () => {\n        console.log('SAVING');\n        if(contextBoard.groups.useTeams){\n            const teamsNoFrontendIDs = contextBoard.groups.teams.map(team => {\n                if(!team._id || team._id.includes('team')){\n                    return {\n                        name: team.name,\n                        accessCode: team.accessCode\n                    }\n                }\n                return team\n            })\n            contextBoard.groups.teams = teamsNoFrontendIDs;\n        }\n        try {\n            const request = await fetch(`${FULL_URL}/boards/${contextBoard._id}`, {\n                method: 'PATCH',\n                headers: {\n                  'Accept': 'application/json',\n                  'Content-Type': 'application/json',\n                  'Authorization': `Bearer ${localStorage.getItem('bingo_token')}`\n                },\n                body: JSON.stringify({\n                    ...contextBoard,\n                    modified: new Date(),\n                })\n              })\n              const success = await request.json();\n              console.log({success})\n              if(success){\n                setStuffToSave(false);\n                setContextBoard(success.board);\n              } else {\n                  alert('There was a problem saving your board... please try again later!')\n              }\n\n        } catch(err) {alert(err)}\n        \n    }\n\n    const getAllGamesForBoard = async boardID => {\n        try {\n            const request = await fetch(`${FULL_URL}/boards/gamesForBoard/${boardID}`, {\n                method: 'GET',\n                headers: {\n                        'Accept': 'application/json',\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${localStorage.getItem('bingo_token')}`\n                    },\n                })\n                const games = await request.json();\n                setGamesForBoard(!games.length ? ['none'] : games);\n        } catch(err) {alert(err)}\n    }\n\n\n    return (\n        <ManageBoardsContext.Provider \n            value={{ \n                contextBoard, \n                updateBoard: setContextBoard, \n                getBoard, \n                newBoard, \n                setStuffToSave,\n                stuffToSave,\n                saveBoard,\n                getAllGamesForBoard,\n                gamesForBoard,\n            }}>\n            {props.children}\n        </ManageBoardsContext.Provider>\n    )\n}\n\nexport default ManageBoardsContextProvider;"]},"metadata":{},"sourceType":"module"}